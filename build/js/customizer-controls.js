(()=>{"use strict";document.addEventListener("DOMContentLoaded",(()=>{!function(){if("undefined"==typeof jQuery||"undefined"==typeof wp||!wp.customize)return;const e=jQuery,t=wp.customize;t.controlConstructor.repeater=t.Control.extend({ready:function(){this.initRepeater(),this.bindEvents()},initRepeater:function(){var e=this,t=e.setting.get(),a=[];try{a=JSON.parse(t)||[]}catch(e){a=[]}Array.isArray(a)||(a=e.migrateOldData()),e.renderItems(a),e.updateValue()},migrateOldData:function(){var e=[],a=t("footer_partner_1")?t("footer_partner_1").get():"",i=t("footer_partner_2")?t("footer_partner_2").get():"";return a&&e.push({image_id:a,width:"",height:""}),i&&e.push({image_id:i,width:"",height:""}),e},bindEvents:function(){var t=this,a=t.container;a.on("click","[data-repeater-add]",(function(e){e.preventDefault(),t.addItem()})),a.on("click","[data-repeater-remove]",(function(a){a.preventDefault();var i=e(this).closest("[data-repeater-item]");t.removeItem(i)})),a.on("click","[data-repeater-toggle]",(function(a){a.preventDefault();var i=e(this).closest("[data-repeater-item]");t.toggleItem(i)})),a.on("change keyup",".repeater-input",(function(){t.updateValue(),t.updatePreview()})),a.on("click","[data-media-select]",(function(a){a.preventDefault();var i=e(this).data("media-select");t.selectMedia(i)})),a.on("click","[data-media-remove]",(function(a){a.preventDefault();var i=e(this).data("media-remove");t.removeMedia(i)})),t.makeSortable()},renderItems:function(t){var a=this,i=a.container.find("[data-repeater-items]");e("#repeater-item-template-"+a.id),i.empty(),t.forEach((function(e,t){a.renderItem(e,t)}))},renderItem:function(t,a){var i=this.container.find("[data-repeater-items]"),n=e("#repeater-item-template-"+this.id).html(),r="display:none;";if((t=e.extend({image_id:"",width:"",height:"",width_unit:"rem",height_unit:"rem"},t)).image_id){var d=wp.media.attachment(t.image_id);d.fetch().then((function(){var e=d.get("url");i.find('[data-media-preview="'+a+'"] img').attr("src",e).show(),i.find('[data-media-remove="'+a+'"]').show()})),r=""}n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=n.replace(/{{index}}/g,a)).replace(/{{itemNumber}}/g,a+1)).replace(/{{image_id}}/g,t.image_id)).replace(/{{width}}/g,t.width)).replace(/{{height}}/g,t.height)).replace(/{{imageUrl}}/g,"")).replace(/{{imageStyle}}/g,"display:none;")).replace(/{{removeStyle}}/g,r)).replace(/{{width_unit_rem}}/g,"rem"===t.width_unit?"selected":"")).replace(/{{width_unit_px}}/g,"px"===t.width_unit?"selected":"")).replace(/{{width_unit_percent}}/g,"%"===t.width_unit?"selected":"")).replace(/{{width_unit_auto}}/g,"auto"===t.width_unit?"selected":"")).replace(/{{height_unit_rem}}/g,"rem"===t.height_unit?"selected":"")).replace(/{{height_unit_px}}/g,"px"===t.height_unit?"selected":"")).replace(/{{height_unit_percent}}/g,"%"===t.height_unit?"selected":"")).replace(/{{height_unit_auto}}/g,"auto"===t.height_unit?"selected":""),i.append(n)},addItem:function(){var e=this,t=(e.container.find("[data-repeater-items]"),e.getItems());e.renderItem({image_id:"",width:"",height:"",width_unit:"rem",height_unit:"rem"},t.length),e.updateValue(),e.updatePreview()},removeItem:function(e){var t=this;e.fadeOut(200,(function(){e.remove(),t.reindexItems(),t.updateValue(),t.updatePreview()}))},toggleItem:function(e){var t=e.find(".repeater-item-content"),a=e.find("[data-repeater-toggle] .dashicons");t.slideToggle(200),a.toggleClass("dashicons-arrow-down dashicons-arrow-up")},selectMedia:function(e){var t,a=this;(t=wp.media({title:"Select Partner Logo",button:{text:"Use this image"},multiple:!1})).on("select",(function(){var i=t.state().get("selection").first().toJSON(),n=a.container;n.find('[data-repeater-item][data-index="'+e+'"] .repeater-media-id').val(i.id),n.find('[data-media-preview="'+e+'"] img').attr("src",i.url).attr("data-image-id",i.id).show(),n.find('[data-media-remove="'+e+'"]').show(),a.updateValue(),a.updatePreview()})),t.open()},removeMedia:function(e){var t=this,a=t.container;a.find('[data-repeater-item][data-index="'+e+'"] .repeater-media-id').val(""),a.find('[data-media-preview="'+e+'"] img').hide(),a.find('[data-media-remove="'+e+'"]').hide(),t.updateValue(),t.updatePreview()},makeSortable:function(){var t=this,a=t.container.find("[data-repeater-items]");e.fn.sortable&&a.sortable({items:"[data-repeater-item]",handle:".repeater-item-header",axis:"y",update:function(){t.reindexItems(),t.updateValue(),t.updatePreview()}})},reindexItems:function(){this.container.find("[data-repeater-item]").each((function(t){var a=e(this);a.attr("data-index",t),a.find(".item-number").text(t+1),a.find("[data-media-select]").attr("data-media-select",t),a.find("[data-media-remove]").attr("data-media-remove",t),a.find("[data-media-preview]").attr("data-media-preview",t)}))},getItems:function(){var t=this.container,a=[];return t.find("[data-repeater-item]").each((function(){var t=e(this),i={};t.find(".repeater-input, .repeater-media-id").each((function(){var t=e(this).data("field"),a=e(this).val();t&&(i[t]=a)})),a.push(i)})),a},updateValue:function(){var e=this,t=e.getItems(),a=JSON.stringify(t);e.setting.set(a),e.container.find("[data-repeater-value]").val(a).trigger("change")},updatePreview:function(){var e=this;e.setting&&e.setting.callbacks.fireWith(e.setting,[e.setting.get()])}})}(),function(){if("undefined"==typeof jQuery||"undefined"==typeof wp||!wp.customize)return;const e=jQuery,t=wp.customize;t.bind("ready",(function(){e(document).on("click",".wpml-lang-button",(function(a){a.preventDefault();var i=e(this),n=i.data("language"),r=i.closest(".wpml-language-switcher-control"),d=r.find(".wpml-language-notice");i.hasClass("active")||(d.show(),e(".wpml-lang-button").removeClass("active"),i.addClass("active"),e.ajax({url:wpmlCustomizer.ajaxUrl,type:"POST",data:{action:"wpml_customizer_change_language",language:n,nonce:wpmlCustomizer.nonce},success:function(a){if(a.success){e.each(a.data.values,(function(e,a){var i=t(e);i&&i.set(a)}));var i=function(e){var t=wpmlCustomizer.homeUrl||window.location.origin,a=wpmlCustomizer.urlFormat||1;return e===(wpmlCustomizer.defaultLang||"en")&&1==a?t+"/":1==a?t+"/"+e+"/":3==a?t+"/?lang="+e:t+"/"}(n);i&&t.previewer.previewUrl.set(i),d.hide(),r.find(".current-language").text(n.toUpperCase())}else alert("Failed to switch language: "+(a.data||"Unknown error")),d.hide()},error:function(){alert("Failed to switch language. Please try again."),d.hide()}}))})),e(document).ready((function(){var t;t=wpmlCustomizer.currentLanguage||"en",e('.wpml-lang-button[data-language="'+t+'"]').addClass("active"),e(".current-language").text(t.toUpperCase())}))}))}()}))})();